/*! For license information please see 546.fdbd331b.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkinkwell_frontend=self.webpackChunkinkwell_frontend||[]).push([[546],{1680:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},2574:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},3546:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var a=t(8),r=t(5043),l=t(2339),c=t(4459),n=t(1680),o=t(2574),i=t(4918),d=t(3528),m=t(4265),h=t(4319),x=t(614);const p=(0,t(1639).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var b=t(9855),u=t(7365),y=t(579);const j="".concat("http://localhost:5000","/api/admin"),g=[{key:"users",label:"Users",icon:(0,y.jsx)(c.A,{className:"inline h-5 w-5 mr-1"})},{key:"posts",label:"Posts",icon:(0,y.jsx)(n.A,{className:"inline h-5 w-5 mr-1"})},{key:"comments",label:"Comments",icon:(0,y.jsx)(o.A,{className:"inline h-5 w-5 mr-1"})},{key:"likes",label:"Likes",icon:(0,y.jsx)(i.A,{className:"inline h-5 w-5 mr-1 text-red-500"})},{key:"bookmarks",label:"Bookmarks",icon:(0,y.jsx)(d.A,{className:"inline h-5 w-5 mr-1 text-indigo-500"})}];const k=function(){const[e,s]=(0,r.useState)("users"),[t,c]=(0,r.useState)([]),[n,o]=(0,r.useState)([]),[i,d]=(0,r.useState)([]),[k,N]=(0,r.useState)(!1),[w,f]=(0,r.useState)(""),[v,A]=(0,r.useState)(null),[C,E]=(0,r.useState)({}),[_,T]=(0,r.useState)(null),[D,S]=(0,r.useState)([]),[F,z]=(0,r.useState)([]),M=localStorage.getItem("token"),L=async()=>{f(""),N(!0);try{const s=localStorage.getItem("token"),t={credentials:"include",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}};if("users"===e){const e=await fetch("".concat(j,"/users?limit=50"),t);if(!e.ok)throw new Error("Failed to fetch users: ".concat(e.status," ").concat(e.statusText));const s=await e.json();c(s.users||[])}else if("posts"===e){const e=await fetch("".concat(j,"/posts?limit=50"),t);if(!e.ok)throw new Error("Failed to fetch posts: ".concat(e.status," ").concat(e.statusText));const s=await e.json();o(s.posts||[])}else if("comments"===e){const e=await fetch("".concat(j,"/comments?limit=50"),t);if(!e.ok)throw new Error("Failed to fetch comments: ".concat(e.status," ").concat(e.statusText));const s=await e.json();d(s.comments||[])}else if("likes"===e){const[e,s]=await Promise.all([fetch("".concat(j,"/posts?limit=100"),t),fetch("".concat(j,"/comments?limit=100"),t)]);if(!e.ok)throw new Error("Failed to fetch posts for likes: ".concat(e.status," ").concat(e.statusText));if(!s.ok)throw new Error("Failed to fetch comments for likes: ".concat(s.status," ").concat(s.statusText));const a=await e.json(),r=await s.json();let l=[];(a.posts||[]).forEach(e=>{e.likeCount>0&&l.push({_id:"".concat(e._id,"-likes"),type:"post",count:e.likeCount,post:{_id:e._id,title:e.title,slug:e.slug}})}),(r.comments||[]).forEach(e=>{e.likeCount>0&&l.push({_id:"".concat(e._id,"-likes"),type:"comment",count:e.likeCount,comment:{_id:e._id,content:e.content.substring(0,100)}})}),S(l)}else if("bookmarks"===e){const e=await fetch("".concat(j,"/users?limit=50"),t);if(!e.ok)throw new Error("Failed to fetch users for bookmarks: ".concat(e.status," ").concat(e.statusText));const s=await e.json();let a=[];(s.users||[]).forEach(e=>{e.bookmarks&&e.bookmarks.length>0&&a.push({_id:"".concat(e._id,"-bookmarks"),user:{_id:e._id,username:e.username,email:e.email},bookmarkCount:e.bookmarks.length,bookmarks:e.bookmarks.slice(0,5)})}),z(a)}N(!1)}catch(s){f(s.message||"Failed to fetch data"),N(!1),console.error("AdminDashboard fetch error:",s)}};(0,r.useEffect)(()=>{L(),A(null),E({})},[e]);const I=e=>{A(e._id),E(e),T({type:"edit",id:e._id,data:e})},B=()=>{A(null),E({}),T(null)},U=async(e,s)=>{T({type:"delete",id:s})},P=e=>{E((0,a.A)((0,a.A)({},C),{},{[e.target.name]:e.target.value}))};return(0,y.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,y.jsxs)("h1",{className:"text-3xl font-bold mb-6 flex items-center",children:[(0,y.jsx)(u.A,{className:"h-7 w-7 mr-2 text-indigo-600"}),"Admin Dashboard"]}),(0,y.jsx)("div",{className:"flex gap-2 mb-8 border-b pb-2",children:g.map(t=>(0,y.jsxs)("button",{onClick:()=>s(t.key),className:"flex items-center px-4 py-2 rounded-t-lg border-b-2 transition-all ".concat(e===t.key?"border-indigo-600 bg-indigo-50 dark:bg-gray-900 font-bold":"border-transparent bg-gray-100 dark:bg-gray-800"),title:t.label,children:[t.icon,t.label]},t.key))}),k&&(0,y.jsx)("div",{children:"Loading..."}),w&&(0,y.jsxs)("div",{className:"bg-red-100 text-red-700 p-4 rounded mb-4",children:[(0,y.jsx)("strong",{children:"Error:"})," ",w]}),"users"===e&&(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full border rounded-lg shadow-sm bg-white dark:bg-gray-900",children:[(0,y.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"border px-2 py-2",children:"ID"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Username"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Email"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Role"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Actions"})]})}),(0,y.jsx)("tbody",{children:t.map(e=>(0,y.jsxs)("tr",{className:"hover:bg-indigo-50 dark:hover:bg-gray-800",children:[(0,y.jsx)("td",{className:"border px-2 py-1 text-xs",children:e._id}),(0,y.jsx)("td",{className:"border px-2 py-1",children:e.username}),(0,y.jsx)("td",{className:"border px-2 py-1",children:e.email}),(0,y.jsx)("td",{className:"border px-2 py-1 capitalize",children:e.role}),(0,y.jsxs)("td",{className:"border px-2 py-1",children:[(0,y.jsx)("button",{className:"text-blue-600 hover:underline mr-2",title:"Edit",onClick:()=>I(e),children:(0,y.jsx)(m.A,{className:"h-4 w-4 inline"})}),(0,y.jsx)("button",{className:"text-red-600 hover:underline",title:"Delete",onClick:()=>U(0,e._id),children:(0,y.jsx)(b.A,{className:"h-4 w-4 inline"})})]})]},e._id))})]})}),"posts"===e&&(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full border rounded-lg shadow-sm bg-white dark:bg-gray-900",children:[(0,y.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"border px-2 py-2",children:"ID"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Title"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Author"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Actions"})]})}),(0,y.jsx)("tbody",{children:n.map(e=>{var s;return(0,y.jsxs)("tr",{className:"hover:bg-indigo-50 dark:hover:bg-gray-800",children:[(0,y.jsx)("td",{className:"border px-2 py-1 text-xs",children:e._id}),(0,y.jsx)("td",{className:"border px-2 py-1",children:e.title}),(0,y.jsx)("td",{className:"border px-2 py-1",children:(null===(s=e.author)||void 0===s?void 0:s.username)||"-"}),(0,y.jsxs)("td",{className:"border px-2 py-1",children:[(0,y.jsx)("button",{className:"text-blue-600 hover:underline mr-2",title:"Edit",onClick:()=>I(e),children:(0,y.jsx)(m.A,{className:"h-4 w-4 inline"})}),(0,y.jsx)("button",{className:"text-red-600 hover:underline",title:"Delete",onClick:()=>U(0,e._id),children:(0,y.jsx)(b.A,{className:"h-4 w-4 inline"})})]})]},e._id)})})]})}),"comments"===e&&(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full border rounded-lg shadow-sm bg-white dark:bg-gray-900",children:[(0,y.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"border px-2 py-2",children:"ID"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Content"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Author"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Post"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Actions"})]})}),(0,y.jsx)("tbody",{children:i.map(e=>{var s,t;return(0,y.jsxs)("tr",{className:"hover:bg-indigo-50 dark:hover:bg-gray-800",children:[(0,y.jsx)("td",{className:"border px-2 py-1 text-xs",children:e._id}),(0,y.jsx)("td",{className:"border px-2 py-1",children:e.content}),(0,y.jsx)("td",{className:"border px-2 py-1",children:(null===(s=e.author)||void 0===s?void 0:s.username)||"-"}),(0,y.jsx)("td",{className:"border px-2 py-1",children:(null===(t=e.post)||void 0===t?void 0:t.title)||"-"}),(0,y.jsxs)("td",{className:"border px-2 py-1",children:[(0,y.jsx)("button",{className:"text-blue-600 hover:underline mr-2",title:"Edit",onClick:()=>I(e),children:(0,y.jsx)(m.A,{className:"h-4 w-4 inline"})}),(0,y.jsx)("button",{className:"text-red-600 hover:underline",title:"Delete",onClick:()=>U(0,e._id),children:(0,y.jsx)(b.A,{className:"h-4 w-4 inline"})})]})]},e._id)})})]})}),"likes"===e&&(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full border rounded-lg shadow-sm bg-white dark:bg-gray-900",children:[(0,y.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"border px-2 py-2",children:"Type"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"User ID"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Post/Comment"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Actions"})]})}),(0,y.jsx)("tbody",{children:D.map(e=>(0,y.jsxs)("tr",{className:"hover:bg-indigo-50 dark:hover:bg-gray-800",children:[(0,y.jsx)("td",{className:"border px-2 py-1 capitalize",children:e.type}),(0,y.jsx)("td",{className:"border px-2 py-1",children:e.user}),(0,y.jsx)("td",{className:"border px-2 py-1",children:"post"===e.type?e.post.title:e.comment.content}),(0,y.jsx)("td",{className:"border px-2 py-1",children:(0,y.jsx)("button",{className:"text-red-600 hover:underline",title:"Remove Like",onClick:()=>(async e=>{let s="";"post"===e.type&&(s="".concat(j,"/posts/").concat(e.post._id,"/like/").concat(e.user)),"comment"===e.type&&(s="".concat(j,"/comments/").concat(e.comment._id,"/like/").concat(e.user));try{if(!(await fetch(s,{method:"DELETE",headers:{Authorization:"Bearer ".concat(M),"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error;l.Ay.success("Like removed"),L()}catch(t){l.Ay.error("Failed to remove like")}})(e),children:(0,y.jsx)(b.A,{className:"h-4 w-4 inline"})})})]},e._id))})]})}),"bookmarks"===e&&(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full border rounded-lg shadow-sm bg-white dark:bg-gray-900",children:[(0,y.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"border px-2 py-2",children:"User"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Post ID"}),(0,y.jsx)("th",{className:"border px-2 py-2",children:"Actions"})]})}),(0,y.jsx)("tbody",{children:F.map(e=>(0,y.jsxs)("tr",{className:"hover:bg-indigo-50 dark:hover:bg-gray-800",children:[(0,y.jsx)("td",{className:"border px-2 py-1",children:e.user.username}),(0,y.jsx)("td",{className:"border px-2 py-1",children:e.postId}),(0,y.jsx)("td",{className:"border px-2 py-1",children:(0,y.jsx)("button",{className:"text-red-600 hover:underline",title:"Remove Bookmark",onClick:()=>(async e=>{let s="".concat(j,"/users/").concat(e.user._id,"/bookmark/").concat(e.postId);try{if(!(await fetch(s,{method:"DELETE",headers:{Authorization:"Bearer ".concat(M),"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error;l.Ay.success("Bookmark removed"),L()}catch(t){l.Ay.error("Failed to remove bookmark")}})(e),children:(0,y.jsx)(b.A,{className:"h-4 w-4 inline"})})})]},e._id))})]})}),_?"edit"===_.type?(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md shadow-lg",children:[(0,y.jsxs)("h3",{className:"text-lg font-bold mb-4 flex items-center",children:[(0,y.jsx)(m.A,{className:"h-5 w-5 mr-2"}),"Edit ",e.slice(0,-1)]}),"users"===e&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("label",{className:"block mb-2",children:"Username"}),(0,y.jsx)("input",{name:"username",value:C.username||"",onChange:P,className:"w-full border px-2 py-1 rounded mb-3 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,y.jsx)("label",{className:"block mb-2",children:"Email"}),(0,y.jsx)("input",{name:"email",value:C.email||"",onChange:P,className:"w-full border px-2 py-1 rounded mb-3 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,y.jsx)("label",{className:"block mb-2",children:"Role"}),(0,y.jsxs)("select",{name:"role",value:C.role||"reader",onChange:P,className:"w-full border px-2 py-1 rounded mb-3 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[(0,y.jsx)("option",{value:"admin",children:"admin"}),(0,y.jsx)("option",{value:"author",children:"author"}),(0,y.jsx)("option",{value:"reader",children:"reader"})]})]}),"posts"===e&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("label",{className:"block mb-2",children:"Title"}),(0,y.jsx)("input",{name:"title",value:C.title||"",onChange:P,className:"w-full border px-2 py-1 rounded mb-3 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),"comments"===e&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("label",{className:"block mb-2",children:"Content"}),(0,y.jsx)("input",{name:"content",value:C.content||"",onChange:P,className:"w-full border px-2 py-1 rounded mb-3 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,y.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,y.jsxs)("button",{className:"px-4 py-2 bg-green-600 text-white rounded flex items-center",onClick:()=>(async e=>{let s="";"users"===e&&(s="".concat(j,"/users/").concat(v)),"posts"===e&&(s="".concat(j,"/posts/").concat(v)),"comments"===e&&(s="".concat(j,"/comments/").concat(v));try{if(!(await fetch(s,{method:"PUT",headers:{Authorization:"Bearer ".concat(M),"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(C)})).ok)throw new Error("Failed to update");l.Ay.success("Updated successfully"),L(),A(null),E({}),T(null)}catch(t){l.Ay.error("Update failed")}})(e),children:[(0,y.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"Save"]}),(0,y.jsxs)("button",{className:"px-4 py-2 bg-gray-400 text-white rounded flex items-center",onClick:B,children:[(0,y.jsx)(x.A,{className:"h-4 w-4 mr-1"}),"Cancel"]})]})]})}):"delete"===_.type?(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md shadow-lg",children:[(0,y.jsxs)("h3",{className:"text-lg font-bold mb-4 flex items-center text-red-600",children:[(0,y.jsx)(p,{className:"h-5 w-5 mr-2"}),"Confirm Delete"]}),(0,y.jsxs)("p",{className:"mb-4",children:["Are you sure you want to delete this ",e.slice(0,-1),"?"]}),(0,y.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,y.jsxs)("button",{className:"px-4 py-2 bg-red-600 text-white rounded flex items-center",onClick:()=>(async(e,s)=>{let t="";"users"===e&&(t="".concat(j,"/users/").concat(s)),"posts"===e&&(t="".concat(j,"/posts/").concat(s)),"comments"===e&&(t="".concat(j,"/comments/").concat(s));try{if(!(await fetch(t,{method:"DELETE",headers:{Authorization:"Bearer ".concat(M),"Content-Type":"application/json"},credentials:"include"})).ok)throw new Error("Failed to delete");l.Ay.success("Deleted successfully"),L(),T(null)}catch(a){l.Ay.error("Delete failed")}})(e,_.id),children:[(0,y.jsx)(b.A,{className:"h-4 w-4 mr-1"}),"Delete"]}),(0,y.jsxs)("button",{className:"px-4 py-2 bg-gray-400 text-white rounded flex items-center",onClick:B,children:[(0,y.jsx)(x.A,{className:"h-4 w-4 mr-1"}),"Cancel"]})]})]})}):null:null]})}},4265:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},4319:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},4918:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},9855:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=546.fdbd331b.chunk.js.map
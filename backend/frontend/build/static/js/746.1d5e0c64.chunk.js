/*! For license information please see 746.1d5e0c64.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkinkwell_frontend=self.webpackChunkinkwell_frontend||[]).push([[746],{9746:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var s=a(5043),r=a(3216),l=a(5475),o=a(9490),n=a(2811),i=a(9156),c=a(8646),d=a(1639);const m=(0,d.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var x=a(4918),u=a(3528);const g=(0,d.A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var h=a(2574),y=a(5016),p=a(9643),f=a(2339),v=a(6536),b=a(579);const j=()=>{var e,t,a,d,j;const{slug:N}=(0,r.g)(),{user:k,isAuthenticated:w}=(0,y.A)(),[A,E]=(0,s.useState)(null),[C,_]=(0,s.useState)(!0),[S,R]=(0,s.useState)(null),[L,D]=(0,s.useState)([]),[O,B]=(0,s.useState)(!1),[T,I]=(0,s.useState)(""),[q,z]=(0,s.useState)(!1),[P,F]=(0,s.useState)(!1),[M,H]=(0,s.useState)(!1),[U,G]=(0,s.useState)(0),[W,Y]=(0,s.useState)(0),J=(0,s.useRef)(!1);(0,s.useEffect)(()=>{const e=()=>{const e=window.scrollY,t=document.documentElement.scrollHeight-window.innerHeight,a=Math.min(e/t*100,100);Y(a)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{_(!0),console.log("\ud83d\udcd6 Loading main post content...");const t=await v.Ay.get("/api/posts/".concat(N));e&&(E(t.data.post),console.log("\u2705 Main post content loaded"))}catch(S){if(null!==S&&void 0!==S&&S.aborted||"ECONNABORTED"===S.code||"ERR_CANCELED"===S.code||"canceled"===S.message||"AbortError"===S.name)return void console.log("\ud83d\uded1 Post fetch request was aborted");console.error("Error fetching post:",S),e&&R("Post not found")}finally{e&&_(!1)}})(),()=>{e=!1}},[N]),(0,s.useEffect)(()=>{if(!A||O||J.current)return;const e=setTimeout(()=>{(async()=>{try{B(!0),console.log("\ud83d\udcac Loading comments...");const e=await v.Ay.get("/api/posts/".concat(A._id,"/comments"));D(Array.isArray(e.data.comments)?e.data.comments:[]),J.current=!0,console.log("\u2705 Comments loaded")}catch(e){if(null!==e&&void 0!==e&&e.aborted||"ECONNABORTED"===e.code||"ERR_CANCELED"===e.code||"canceled"===e.message||"AbortError"===e.name)return void console.log("\ud83d\uded1 Comments fetch request was aborted");console.error("Error fetching comments:",e),D([])}finally{B(!1)}})()},100);return()=>clearTimeout(e)},[null===A||void 0===A?void 0:A._id]),(0,s.useEffect)(()=>{J.current=!1,D([])},[null===A||void 0===A?void 0:A._id]),(0,s.useEffect)(()=>{var e,t;A&&k&&(F(null===(e=A.likes)||void 0===e?void 0:e.includes(k._id)),H(null===(t=k.bookmarks)||void 0===t?void 0:t.includes(A._id)),G(A.likeCount||0))},[A,k]);return C?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)(p.A,{size:"xl"})}):S||!A?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Post not found"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"The post you're looking for doesn't exist or has been removed."}),(0,b.jsx)(l.N_,{to:"/",className:"btn-primary",children:"Go Home"})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(o.mg,{children:[(0,b.jsxs)("title",{children:[A.title," - InkWell"]}),(0,b.jsx)("meta",{name:"description",content:A.excerpt}),(0,b.jsx)("meta",{property:"og:title",content:A.title}),(0,b.jsx)("meta",{property:"og:description",content:A.excerpt}),A.featuredImage&&(0,b.jsx)("meta",{property:"og:image",content:A.featuredImage})]}),(0,b.jsx)("div",{className:"fixed top-0 left-0 w-full h-1 bg-gray-200 dark:bg-gray-700 z-50",children:(0,b.jsx)("div",{className:"h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-300 ease-out",style:{width:"".concat(W,"%")}})}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("article",{className:"mb-8",children:[A.featuredImage&&(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)("img",{src:A.featuredImage,alt:A.title,className:"w-full h-64 md:h-96 object-cover rounded-lg transition-opacity duration-300",loading:"lazy",onError:e=>{console.log("\ud83d\uddbc\ufe0f Image failed to load, using fallback"),e.target.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='400' viewBox='0 0 800 400'%3E%3Crect width='800' height='400' fill='%23f3f4f6'/%3E%3Ctext x='400' y='200' text-anchor='middle' fill='%236b7280' font-family='system-ui' font-size='16'%3EImage not available%3C/text%3E%3C/svg%3E",e.target.classList.add("opacity-50")},onLoad:e=>{e.target.classList.remove("opacity-50")}})}),(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:A.title}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("div",{className:"flex items-center space-x-4",children:(0,b.jsxs)(l.N_,{to:"/profile/".concat(null===(e=A.author)||void 0===e?void 0:e.username),className:"flex items-center space-x-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[null!==(t=A.author)&&void 0!==t&&t.avatar?(0,b.jsx)("img",{src:A.author.avatar,alt:A.author.username,className:"w-10 h-10 rounded-full",onError:e=>{console.log("\ud83d\uddbc\ufe0f Author avatar failed to load"),e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):(0,b.jsx)("div",{className:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white font-medium",children:null===(a=A.author)||void 0===a||null===(d=a.username)||void 0===d?void 0:d.charAt(0).toUpperCase()})}),(0,b.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:null===(j=A.author)||void 0===j?void 0:j.username})]})}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)(c.A,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:(0,n.A)(new Date(A.createdAt),{addSuffix:!0})})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)(m,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[(e=>{if(!e)return 5;const t=e.split(/\s+/).length,a=Math.ceil(t/200);return Math.max(a,1)})(A.content)," min read"]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,b.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium text-primary-600 bg-primary-100 dark:bg-primary-900/30 dark:text-primary-400 rounded-full",children:A.category}),A.tags&&A.tags.length>0&&(0,b.jsx)("div",{className:"flex items-center space-x-2",children:A.tags.map(e=>(0,b.jsxs)(l.N_,{to:"/search?tag=".concat(e),className:"text-sm text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400",children:["#",e]},e))})]}),(0,b.jsx)("div",{className:"flex items-center justify-between mb-8 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("button",{onClick:async()=>{if(w){F(e=>!e),G(e=>P?e-1:e+1);try{await v.Ay.post("/api/posts/".concat(A._id,"/like"))}catch(e){if(null!==e&&void 0!==e&&e.aborted||"ECONNABORTED"===e.code||"ERR_CANCELED"===e.code||"canceled"===e.message||"AbortError"===e.name)return void console.log("\ud83d\uded1 Like request was aborted");F(e=>!e),G(e=>P?e+1:e-1),f.Ay.error("Failed to like post")}}else f.Ay.error("Please login to like posts")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ".concat(P?"text-red-600 bg-red-100 dark:bg-red-900/30":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:[(0,b.jsx)(x.A,{className:"h-5 w-5 ".concat(P?"fill-current":"")}),(0,b.jsx)("span",{children:U})]}),(0,b.jsxs)("button",{onClick:async()=>{if(w){H(e=>!e);try{await v.Ay.post("/api/posts/".concat(A._id,"/bookmark"))}catch(e){if(null!==e&&void 0!==e&&e.aborted||"ECONNABORTED"===e.code||"ERR_CANCELED"===e.code||"canceled"===e.message||"AbortError"===e.name)return void console.log("\ud83d\uded1 Bookmark request was aborted");H(e=>!e),f.Ay.error("Failed to update bookmark")}}else f.Ay.error("Please login to bookmark posts")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ".concat(M?"text-blue-600 bg-blue-100 dark:bg-blue-900/30":"text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400"),children:[(0,b.jsx)(u.A,{className:"h-5 w-5 ".concat(M?"fill-current":"")}),(0,b.jsx)("span",{children:"Bookmark"})]}),(0,b.jsxs)("button",{onClick:()=>{navigator.share?navigator.share({title:A.title,text:A.excerpt,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),f.Ay.success("Link copied to clipboard"))},className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:[(0,b.jsx)(g,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Share"})]})]})}),(0,b.jsx)("div",{className:"prose prose-lg max-w-none dark:prose-invert",children:(0,b.jsx)(i.oz,{children:A.content})})]}),(0,b.jsxs)("section",{className:"mt-12",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-6",children:[(0,b.jsx)(h.A,{className:"h-6 w-6 text-gray-600 dark:text-gray-400"}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Comments"}),O&&(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(p.A,{size:"sm"}),(0,b.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading comments..."})]})]}),w&&(0,b.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),T.trim()){z(!0);try{await v.Ay.post("/api/comments",{content:T,postId:A._id}),I("");const e=await v.Ay.get("/api/posts/".concat(A._id,"/comments"));D(Array.isArray(e.data.comments)?e.data.comments:[]),f.Ay.success("Comment added successfully")}catch(t){if(null!==t&&void 0!==t&&t.aborted||"ECONNABORTED"===t.code||"ERR_CANCELED"===t.code||"canceled"===t.message||"AbortError"===t.name)return void console.log("\ud83d\uded1 Comment request was aborted");f.Ay.error("Failed to add comment")}finally{z(!1)}}},className:"mb-8",children:[(0,b.jsx)("textarea",{value:T,onChange:e=>I(e.target.value),placeholder:"Share your thoughts...",className:"w-full p-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"3",disabled:q}),(0,b.jsx)("div",{className:"flex justify-end mt-2",children:(0,b.jsx)("button",{type:"submit",disabled:!T.trim()||q,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:q?"Posting...":"Post Comment"})})]}),(0,b.jsx)("div",{className:"space-y-4",children:O?Array.from({length:3}).map((e,t)=>(0,b.jsx)("div",{className:"animate-pulse",children:(0,b.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gray-300 dark:bg-gray-600 rounded-full"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-300 dark:bg-gray-600 rounded w-1/4 mb-2"}),(0,b.jsx)("div",{className:"h-3 bg-gray-300 dark:bg-gray-600 rounded w-full mb-1"}),(0,b.jsx)("div",{className:"h-3 bg-gray-300 dark:bg-gray-600 rounded w-3/4"})]})]})},t)):L.length>0?L.map(e=>{var t,a,s,r;return(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:(0,b.jsxs)("div",{className:"flex items-start space-x-3",children:[null!==(t=e.author)&&void 0!==t&&t.avatar?(0,b.jsx)("img",{src:e.author.avatar,alt:e.author.username,className:"w-10 h-10 rounded-full",onError:e=>{console.log("\ud83d\uddbc\ufe0f Comment avatar failed to load"),e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):(0,b.jsx)("div",{className:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white font-medium",children:null===(a=e.author)||void 0===a||null===(s=a.username)||void 0===s?void 0:s.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:null===(r=e.author)||void 0===r?void 0:r.username}),(0,b.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,n.A)(new Date(e.createdAt),{addSuffix:!0})})]}),(0,b.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:e.content})]})]})},e._id)}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(h.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No comments yet. Be the first to share your thoughts!"})]})})]})]})]})}}}]);
//# sourceMappingURL=746.1d5e0c64.chunk.js.map
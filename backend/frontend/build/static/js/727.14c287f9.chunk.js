/*! For license information please see 727.14c287f9.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkinkwell_frontend=self.webpackChunkinkwell_frontend||[]).push([[727],{797:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},5884:()=>{},8693:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},8727:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=s(8),r=s(5043),l=s(3216),n=s(9490),o=s(4858),d=s(9156),i=(s(5884),s(5087)),c=s(9855),x=s(797),m=s(614),u=s(1360),h=s(8646),p=s(8693),y=s(5016),g=s(9643),b=s(2339),j=s(6536),f=s(579);const k=()=>{const{id:e}=(0,l.g)(),t=(0,l.Zp)(),{user:s}=(0,y.A)(),[k,v]=(0,r.useState)(null),[N,w]=(0,r.useState)(""),[A,C]=(0,r.useState)([]),[P,S]=(0,r.useState)(""),[F,E]=(0,r.useState)(""),[z,D]=(0,r.useState)(!1),[I,T]=(0,r.useState)(!0),[U,L]=(0,r.useState)(!1),[M,q]=(0,r.useState)(!1),{register:_,handleSubmit:H,formState:{errors:V},watch:W,setValue:B,reset:R}=(0,o.mN)(),Y=W("title");(0,r.useEffect)(()=>{(async()=>{try{T(!0);const a=(await j.A.get("/api/posts/id/".concat(e))).data.post;if(a.author._id!==s._id&&"admin"!==s.role)return b.Ay.error("You are not authorized to edit this post"),void t("/");v(a),w(a.content),C(a.tags||[]),E(a.featuredImage||""),D(a.isPublished),R({title:a.title,excerpt:a.excerpt,category:a.category})}catch(a){console.error("Error fetching post:",a),b.Ay.error("Failed to load post"),t("/")}finally{T(!1)}})()},[e,s._id,s.role,B,R,t]);const G=()=>{P.trim()&&!A.includes(P.trim().toLowerCase())&&(C([...A,P.trim().toLowerCase()]),S(""))},K=async function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;L(!0);try{const r=null!==a?a:z,l={title:s.title,content:N,excerpt:s.excerpt||"",category:s.category,tags:A,featuredImage:F,isPublished:r},n=await j.A.put("/api/posts/".concat(e),l);if(!n.data||!n.data.post)throw new Error("Invalid response from server");{const e=!k.isPublished,s=r;e&&s?(b.Ay.success("Draft published successfully! Your post is now live."),t("/post/".concat(n.data.post.slug))):s?(b.Ay.success("Post updated successfully!"),t("/post/".concat(n.data.post.slug))):(b.Ay.success("Draft updated successfully!"),t("/post/".concat(n.data.post.slug)))}}catch(n){var r,l;const e=(null===(r=n.response)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)||"Failed to update post";b.Ay.error(e),console.error("Post update error:",n)}finally{L(!1)}},O=async()=>{if(window.confirm("Are you sure you want to delete this post? This action cannot be undone.")){L(!0);try{await j.A.delete("/api/posts/".concat(e)),b.Ay.success("Post deleted successfully!"),t("/dashboard")}catch(r){var s,a;const e=(null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete post";b.Ay.error(e)}finally{L(!1)}}};return I?(0,f.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,f.jsx)(g.A,{size:"xl"})}):k?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(n.mg,{children:[(0,f.jsx)("title",{children:"Edit Post - InkWell"}),(0,f.jsx)("meta",{name:"description",content:"Edit your blog post"})]}),(0,f.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Edit Post"}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Update your post content and settings"})]}),(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsxs)("button",{onClick:()=>q(!M),className:"btn-outline",children:[(0,f.jsx)(i.A,{className:"h-4 w-4 mr-2"}),M?"Edit":"Preview"]}),(0,f.jsxs)("button",{onClick:O,disabled:U,className:"btn-outline text-red-600 border-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[(0,f.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),M?(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8",children:[(0,f.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:Y||"Untitled Post"}),F&&(0,f.jsx)("img",{src:F,alt:"Featured",className:"w-full h-64 object-cover rounded-lg mb-6",loading:"lazy"}),(0,f.jsx)("div",{className:"prose prose-lg max-w-none dark:prose-invert",children:(0,f.jsx)(d.oz,{children:N})})]}):(0,f.jsxs)("form",{onSubmit:H(K),className:"space-y-8",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Title *"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text"},_("title",{required:"Title is required",maxLength:{value:200,message:"Title cannot exceed 200 characters"}})),{},{className:"input text-2xl font-bold ".concat(V.title?"border-red-500 focus:ring-red-500 focus:border-red-500":""),placeholder:"Enter your post title..."})),V.title&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:V.title.message})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),(0,f.jsxs)("select",(0,a.A)((0,a.A)({},_("category",{required:"Category is required"})),{},{className:"input ".concat(V.category?"border-red-500 focus:ring-red-500 focus:border-red-500":""),children:[(0,f.jsx)("option",{value:"",children:"Select a category"}),["Technology","Design","Business","Lifestyle","Travel","Food","Health","Education","Entertainment","Other"].map(e=>(0,f.jsx)("option",{value:e,children:e},e))]})),V.category&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:V.category.message})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Featured Image"}),(0,f.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,f.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{E(e.target.result)},e.readAsDataURL(t)}},className:"hidden",id:"image-upload"}),(0,f.jsxs)("label",{htmlFor:"image-upload",className:"btn-outline cursor-pointer",children:[(0,f.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Upload Image"]}),F&&(0,f.jsx)("button",{type:"button",onClick:()=>E(""),className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",children:(0,f.jsx)(m.A,{className:"h-4 w-4"})})]}),F&&(0,f.jsx)("div",{className:"mt-4",children:(0,f.jsx)("img",{src:F,alt:"Featured",className:"w-32 h-32 object-cover rounded-lg",loading:"lazy"})})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tags"}),(0,f.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,f.jsx)("input",{type:"text",value:P,onChange:e=>S(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),G()),placeholder:"Add a tag...",className:"input flex-1"}),(0,f.jsx)("button",{type:"button",onClick:G,className:"btn-outline",children:(0,f.jsx)(u.A,{className:"h-4 w-4"})})]}),A.length>0&&(0,f.jsx)("div",{className:"flex flex-wrap gap-2",children:A.map(e=>(0,f.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-400",children:["#",e,(0,f.jsx)("button",{type:"button",onClick:()=>{return t=e,void C(A.filter(e=>e!==t));var t},className:"ml-2 text-primary-600 hover:text-primary-800 dark:text-primary-400 dark:hover:text-primary-300",children:(0,f.jsx)(m.A,{className:"h-3 w-3"})})]},e))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Excerpt"}),(0,f.jsx)("textarea",(0,a.A)((0,a.A)({},_("excerpt",{maxLength:{value:300,message:"Excerpt cannot exceed 300 characters"}})),{},{rows:3,className:"input ".concat(V.excerpt?"border-red-500 focus:ring-red-500 focus:border-red-500":""),placeholder:"Brief description of your post (optional)..."})),V.excerpt&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:V.excerpt.message})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Content *"}),(0,f.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden",children:(0,f.jsx)("textarea",{value:N,onChange:e=>w(e.target.value),rows:15,className:"w-full p-4 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none resize-none font-mono text-sm",placeholder:"# Welcome to InkWell!\n\nStart writing your story in **Markdown** format.\n\n## Features you can use:\n\n- **Bold text** with `**text**`\n- *Italic text* with `*text*`\n- [Links](https://example.com) with `[text](url)`\n- `Inline code` with backticks\n- Lists like this one\n- And much more!\n\nWrite your content here..."})}),(0,f.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:'Use Markdown formatting. Click "Preview" to see how it will look.'})]}),(0,f.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("div",{className:"flex items-center space-x-4",children:(0,f.jsxs)("button",{type:"button",onClick:O,disabled:U,className:"btn-outline text-red-600 border-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[(0,f.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Delete Post"]})}),(0,f.jsx)("div",{className:"flex items-center space-x-4",children:k.isPublished?(0,f.jsx)("button",{type:"button",onClick:()=>{H(e=>K(e,!0))()},disabled:U,className:"btn-primary",children:U?(0,f.jsx)(g.A,{size:"sm"}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Update Post"]})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("button",{type:"button",onClick:()=>{H(e=>K(e,!1))()},disabled:U,className:"btn-outline",children:[(0,f.jsx)(p.A,{className:"h-4 w-4 mr-2"}),U?"Updating...":"Update Draft"]}),(0,f.jsx)("button",{type:"button",onClick:()=>{H(e=>K(e,!0))()},disabled:U,className:"btn-primary",children:U?(0,f.jsx)(g.A,{size:"sm"}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Publish Draft"]})})]})})]})]})]})]}):(0,f.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Post not found"}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"The post you're looking for doesn't exist."}),(0,f.jsx)("button",{onClick:()=>t("/dashboard"),className:"btn-primary",children:"Go to Dashboard"})]})})}},9855:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=727.14c287f9.chunk.js.map